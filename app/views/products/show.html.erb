<%= render 'nav_resume' %>
<%= render 'header' %>
<%= render 'menu' %>

<% content_for :content_menu do %>
  <br>> <%= link_to 'Retour Variante', recipe_variant_path(@recipe, @variant) %>
  <br>> <%= link_to 'Retour Recette', recipe_path(@recipe) %>
<% end %>

<% content_for :item_content do %>

  <h3>Produit <%= @product.name %></h3>
    <table class = "product">
      <tr><th>Résumé</th></tr>
      <tr><td>
          <table>
            <tr><td>Variante : <%= link_to @product.variant.name, recipe_variant_path(@recipe,@product.variant) %></td></tr>
            <tr><td>Volume total : <%= @product.volume.display %> ml</td></tr>
            <% if not @product.price.nil? then %>
              <tr><td>Prix : <%= @product.price %> €</td></tr>
            <% end %>
          </table>
        </td></tr>
      <tr><th>Dosage</th></tr>
        <tr><td>
            <table class = "colored">
            <% @recipe.ingredient_types.each do |it|%>
              <tr>
                <td><strong><%= it.name %></strong></td>
                <td></td>
                <td></td>
                <td></td>
                <!-- <td><i>en stock</i></td> -->
                <tr>
              <% colored = true %>
              <% @recipe.ingredients.where(type: it).each do |i| %>

                <% vol_ml = @product.ingredient_volume(i).display %>
                <% if vol_ml >0 then %>
                  <% if colored then %>
                    <tr class="filled">
                  <% else %>
                    <tr>
                  <% end %>
                  <% colored = !colored %>
                    <td>&nbsp; &nbsp;<%= i.name %></td>
                    <td class="right"><%= @product.ingredient_mass(i).display %> g</td>
                    <td class="right">
                      <% if vol_ml >= 2 then %>  
                        <%= vol_ml %> ml
                      <% end %> </td>
                    <td class="right">
                      <% if vol_ml < 2 then %>  
                        <% if it.name_short == 'HE' then %>
                          <%= (vol_ml*35).round(0) %> gt.
                        <% end %>
                      <% end %>
                    </td>
                    <!-- <td class="center"><%= i.volume_in_stock.round(2) %> ml</td> -->
                  </tr>
                <% end %>
              <% end %>
            <% end %>
          </table></td></tr>
    </table>

<% end %>
